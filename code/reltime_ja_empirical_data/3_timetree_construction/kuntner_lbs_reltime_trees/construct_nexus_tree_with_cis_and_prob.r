



#source(file="/Users/josebarba/Desktop/script.r")
rm(list=ls())
require(ape)

t.true <- ape::read.tree(file="/Users/barba/Desktop/lbs_iqtree_reltime_timetrees/lbs-reltime_ultimate_timetrees/kuntner_lbs_reltime_trees/mrca_node_divtimes_timetree.nwk")
#t <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_utt_cah.timetree")
#t1 = ape::rotateConstr(t, t.true$tip.label) 
#t.new = ape::read.tree(text = ape::write.tree(t1))
#t.true$edge.length <- t.new$edge.length
t.true$node.label <- c("[&CI={1.953514384^2.148992536}^prob=1]","[&CI={1.753845181^1.949249208}^prob=0.75]","[&CI={0.852254648^1.026595296}^prob=1]","[&CI={0.655606759^0.831892242}^prob=1]","[&CI={0.590839996^0.778742451}^prob=1]","[&CI={0.526290317^0.729386029}^prob=1]","[&CI={0.384498697^0.595070281}^prob=1]","[&CI={0.100027929^0.180728169}^prob=1]","[&CI={0.080640063^0.15757461}^prob=1]","[&CI={0.067857418^0.143624817}^prob=0.8]","[&CI={0.008600468^0.046587613}^prob=1]","[&CI={0.025500353^0.077214111}^prob=1]","[&CI={0.047061984^0.108259425}^prob=1]","[&CI={0.138378551^0.241768232}^prob=1]","[&CI={0.27036077^0.385508224}^prob=1]","[&CI={0.209035529^0.337754959}^prob=1]","[&CI={0.136188922^0.242275744}^prob=1]","[&CI={0.124462846^0.23670572}^prob=0.5]","[&CI={0.03011825^0.087745343}^prob=1]",
	"[&CI={0.119620151^0.234105088}^prob=0.95]","[&CI={0.215213823^0.344148624}^prob=1]","[&CI={0.113552107^0.217306395}^prob=1]","[&CI={0.264426887^0.425487021}^prob=1]","[&CI={0.122958455^0.203927051}^prob=1]","[&CI={1.432331207^1.702067662}^prob=1]","[&CI={0.76580006^1.047092884}^prob=1]","[&CI={0.478271723^0.769993888}^prob=1]","[&CI={0.022328216^0.065019038}^prob=1]","[&CI={1.621079909^1.798872527}^prob=0.975]","[&CI={0.3752712^0.578730771}^prob=1]")

write.nexus(t.true, file="/Users/barba/Desktop/lbs_iqtree_reltime_timetrees/lbs-reltime_ultimate_timetrees/kuntner_lbs_reltime_trees/kuntner_ultimate_lbst_timetree.tre")














#source(file="/Users/josebarba/Desktop/script.r")
rm(list=ls())
require(ape)

t.true <- ape::read.tree(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/out_389_FINAL_timetree_no_outgroup.nwk")
t <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_utt_cah.timetree")
t1 = ape::rotateConstr(t, t.true$tip.label) 
t.new = ape::read.tree(text = ape::write.tree(t1))
t.true$edge.length <- t.new$edge.length
t.true$node.label <- c("[&CI={4.480865619^4.613619741}^prob=1]","[&CI={3.435331943^4.053952444}^prob=0.62]","[&CI={2.430813234^3.453300212}^prob=0.74]","[&CI={0.604038276^1.623862635}^prob=1]","[&CI={0.325395665^1.298919095}^prob=0.86]","[&CI={0.272552273^1.295525591}^prob=0.42]","[&CI={0.141433538^1.013796952}^prob=0.73]","[&CI={0.135997508^1.002369944}^prob=0.14]","[&CI={0.135088487^1.00235499}^prob=0.03]","[&CI={0.075392173^0.828939972}^prob=0.79]","[&CI={0.066050922^0.817842967}^prob=0.49]","[&CI={0.075640969^0.864649842}^prob=0.72]","[&CI={0.055912189^0.785690428}^prob=0.61]","[&CI={0.255857401^1.260832967}^prob=0.54]","[&CI={0.240057709^1.260832967}^prob=0.45]","[&CI={0.184500739^1.25995823}^prob=0.7]","[&CI={0.211131846^1.256773497}^prob=0.35]","[&CI={0.030909134^0.617279263}^prob=1]","[&CI={0.215132067^1.091651945}^prob=1]","[&CI={0.161013712^1.079243532}^prob=0.79]","[&CI={1.966064767^3.003649709}^prob=0.76]","[&CI={1.12452999^2.599811611}^prob=0.96]","[&CI={1.042567582^2.591116434}^prob=0.47]","[&CI={0.934552334^2.577308404}^prob=0.52]","[&CI={0.786137803^2.576396249}^prob=0.61]","[&CI={0.5940804^2.567337223}^prob=0.84]","[&CI={1.648850138^2.940719191}^prob=0.86]","[&CI={0.918210866^2.837565302}^prob=0.98]","[&CI={1.19938763^2.895091625}^prob=0.93]","[&CI={0.370198633^1.575860342}^prob=1]","[&CI={0.291738807^1.485781559}^prob=0.66]","[&CI={0.195571821^1.36747337}^prob=0.8]","[&CI={0.153209383^1.284432215}^prob=0.89]","[&CI={0.14828773^1.283005803}^prob=0.6]","[&CI={0.094245034^1.063914276}^prob=1]","[&CI={0.087433982^1.052861466}^prob=0.42]","[&CI={0.061996041^0.965768234}^prob=0.78]","[&CI={0.07431381^1.015638554}^prob=0.69]","[&CI={0.070856181^0.966702569}^prob=1]","[&CI={1.870802705^3.763080409}^prob=0.92]","[&CI={0.076387695^0.656017395}^prob=1]","[&CI={2.965383178^4.01816647}^prob=0.59]","[&CI={1.924893958^3.643620656}^prob=0.88]","[&CI={1.522162223^3.542347785}^prob=0.92]","[&CI={0.812178354^2.644953159}^prob=0.99]","[&CI={0.738121473^2.621542314}^prob=0.74]","[&CI={0.544997053^2.539822755}^prob=0.94]","[&CI={0.502536156^2.538069172}^prob=0.62]","[&CI={0.186574865^1.317922462}^prob=1]")
write.nexus(t.true, file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_ultimate_lbs_prob.timetree")











tree$node.label <- c("[&CI={4.480865619^4.613619741},prob=1]","[&CI={3.435331943^4.053952444},prob=0.62]","[&CI={2.430813234^3.453300212},prob=0.74]","[&CI={0.604038276^1.623862635},prob=0.76]","[&CI={0.325395665^1.298919095},prob=0.86]","[&CI={0.272552273^1.295525591},prob=0.93]","[&CI={0.141433538^1.013796952},prob=1]","[&CI={0.135997508^1.002369944},prob=0.66]","[&CI={0.135088487^1.00235499},prob=0.8]","[&CI={0.075392173^0.828939972},prob=0.89]","[&CI={0.066050922^0.817842967},prob=0.6]","[&CI={0.075640969^0.864649842},prob=1]","[&CI={0.055912189^0.785690428},prob=0.42]","[&CI={0.255857401^1.260832967},prob=0.78]","[&CI={0.240057709^1.260832967},prob=0.69]","[&CI={0.184500739^1.25995823},prob=1]","[&CI={0.211131846^1.256773497},prob=0.98]","[&CI={0.030909134^0.617279263},prob=0.96]","[&CI={0.215132067^1.091651945},prob=0.47]","[&CI={0.161013712^1.079243532},prob=0.52]","[&CI={1.966064767^3.003649709},prob=0.61]","[&CI={1.12452999^2.599811611},prob=0.84]","[&CI={1.042567582^2.591116434},prob=1]","[&CI={0.934552334^2.577308404},prob=1]","[&CI={0.786137803^2.576396249},prob=0.79]","[&CI={0.5940804^2.567337223},prob=0.86]","[&CI={1.648850138^2.940719191},prob=0.54]","[&CI={0.918210866^2.837565302},prob=0.45]","[&CI={1.19938763^2.895091625},prob=0.35]","[&CI={0.370198633^1.575860342},prob=1]","[&CI={0.291738807^1.485781559},prob=0.7]","[&CI={0.195571821^1.36747337},prob=0.42]","[&CI={0.153209383^1.284432215},prob=0.73]","[&CI={0.14828773^1.283005803},prob=0.14]","[&CI={0.094245034^1.063914276},prob=0.03]","[&CI={0.087433982^1.052861466},prob=0.79]","[&CI={0.061996041^0.965768234},prob=0.49]","[&CI={0.07431381^1.015638554},prob=0.72]","[&CI={0.070856181^0.966702569},prob=0.61]","[&CI={1.870802705^3.763080409},prob=0.92]","[&CI={0.076387695^0.656017395},prob=1]","[&CI={2.965383178^4.01816647},prob=0.59]","[&CI={1.924893958^3.643620656},prob=0.88]","[&CI={1.522162223^3.542347785},prob=0.92]","[&CI={0.812178354^2.644953159},prob=0.99]","[&CI={0.738121473^2.621542314},prob=0.74]","[&CI={0.544997053^2.539822755},prob=0.94]","[&CI={0.502536156^2.538069172},prob=0.62]","[&CI={0.186574865^1.317922462},prob=1]")
write.nexus(tree, file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_ultimate_lbs_prob.timetree")









#source(file="/Users/josebarba/Desktop/script.r")
rm(list=ls())
require(ape)

tree <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_utt_cah.timetree")#t.true$edge.length <- t$edge.length
tree$node.label <- c("[&CI={4.480865619^4.613619741},prob=1]","[&CI={3.435331943^4.053952444},prob=0.62]","[&CI={2.430813234^3.453300212},prob=0.74]","[&CI={0.604038276^1.623862635},prob=0.76]","[&CI={0.325395665^1.298919095},prob=0.86]","[&CI={0.272552273^1.295525591},prob=0.93]","[&CI={0.141433538^1.013796952},prob=1]","[&CI={0.135997508^1.002369944},prob=0.66]","[&CI={0.135088487^1.00235499},prob=0.8]","[&CI={0.075392173^0.828939972},prob=0.89]","[&CI={0.066050922^0.817842967},prob=0.6]","[&CI={0.075640969^0.864649842},prob=1]","[&CI={0.055912189^0.785690428},prob=0.42]","[&CI={0.255857401^1.260832967},prob=0.78]","[&CI={0.240057709^1.260832967},prob=0.69]","[&CI={0.184500739^1.25995823},prob=1]","[&CI={0.211131846^1.256773497},prob=0.98]","[&CI={0.030909134^0.617279263},prob=0.96]","[&CI={0.215132067^1.091651945},prob=0.47]","[&CI={0.161013712^1.079243532},prob=0.52]","[&CI={1.966064767^3.003649709},prob=0.61]","[&CI={1.12452999^2.599811611},prob=0.84]","[&CI={1.042567582^2.591116434},prob=1]","[&CI={0.934552334^2.577308404},prob=1]","[&CI={0.786137803^2.576396249},prob=0.79]","[&CI={0.5940804^2.567337223},prob=0.86]","[&CI={1.648850138^2.940719191},prob=0.54]","[&CI={0.918210866^2.837565302},prob=0.45]","[&CI={1.19938763^2.895091625},prob=0.35]","[&CI={0.370198633^1.575860342},prob=1]","[&CI={0.291738807^1.485781559},prob=0.7]","[&CI={0.195571821^1.36747337},prob=0.42]","[&CI={0.153209383^1.284432215},prob=0.73]","[&CI={0.14828773^1.283005803},prob=0.14]","[&CI={0.094245034^1.063914276},prob=0.03]","[&CI={0.087433982^1.052861466},prob=0.79]","[&CI={0.061996041^0.965768234},prob=0.49]","[&CI={0.07431381^1.015638554},prob=0.72]","[&CI={0.070856181^0.966702569},prob=0.61]","[&CI={1.870802705^3.763080409},prob=0.92]","[&CI={0.076387695^0.656017395},prob=1]","[&CI={2.965383178^4.01816647},prob=0.59]","[&CI={1.924893958^3.643620656},prob=0.88]","[&CI={1.522162223^3.542347785},prob=0.92]","[&CI={0.812178354^2.644953159},prob=0.99]","[&CI={0.738121473^2.621542314},prob=0.74]","[&CI={0.544997053^2.539822755},prob=0.94]","[&CI={0.502536156^2.538069172},prob=0.62]","[&CI={0.186574865^1.317922462},prob=1]")
write.nexus(tree, file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_ultimate_lbs_prob.timetree")



#source(file="/Users/josebarba/Desktop/script.r")
rm(list=ls())
require(ape)

t.true <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/out_389_FINAL_timetree_no_outgroup.nwk")
t <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_utt_cah.timetree")
t1 = ape::rotateConstr(t, t.true$tip.label) 
t.new = ape::read.tree(text = ape::write.tree(t1))
t.true$edge.length <- t.new$edge.length

#t.true$node.label <- c("n51","n52","n53","n54","n55","n56","n57","n58","n59","n60","n61","n62","n63","n64","n65","n66","n67","n68","n69","n70","n71","n72","n73","n74","n75","n76","n77","n78","n79","n80","n81","n82","n83","n84","n85","n86","n87","n88","n89","n90","n91","n92","n93","n94","n95","n96","n97","n98","n99")
#t.true$node.label <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49)
t.true$node.label <- c("[&CI={4.480865619^4.613619741},prob=1]","[&CI={3.435331943^4.053952444},prob=0.62]","[&CI={2.430813234^3.453300212},prob=0.74]","[&CI={0.604038276^1.623862635},prob=0.76]","[&CI={0.325395665^1.298919095},prob=0.86]","[&CI={0.272552273^1.295525591},prob=0.93]","[&CI={0.141433538^1.013796952},prob=1]","[&CI={0.135997508^1.002369944},prob=0.66]","[&CI={0.135088487^1.00235499},prob=0.8]","[&CI={0.075392173^0.828939972},prob=0.89]","[&CI={0.066050922^0.817842967},prob=0.6]","[&CI={0.075640969^0.864649842},prob=1]","[&CI={0.055912189^0.785690428},prob=0.42]","[&CI={0.255857401^1.260832967},prob=0.78]","[&CI={0.240057709^1.260832967},prob=0.69]","[&CI={0.184500739^1.25995823},prob=1]","[&CI={0.211131846^1.256773497},prob=0.98]","[&CI={0.030909134^0.617279263},prob=0.96]","[&CI={0.215132067^1.091651945},prob=0.47]","[&CI={0.161013712^1.079243532},prob=0.52]","[&CI={1.966064767^3.003649709},prob=0.61]","[&CI={1.12452999^2.599811611},prob=0.84]","[&CI={1.042567582^2.591116434},prob=1]","[&CI={0.934552334^2.577308404},prob=1]","[&CI={0.786137803^2.576396249},prob=0.79]","[&CI={0.5940804^2.567337223},prob=0.86]","[&CI={1.648850138^2.940719191},prob=0.54]","[&CI={0.918210866^2.837565302},prob=0.45]","[&CI={1.19938763^2.895091625},prob=0.35]","[&CI={0.370198633^1.575860342},prob=1]","[&CI={0.291738807^1.485781559},prob=0.7]","[&CI={0.195571821^1.36747337},prob=0.42]","[&CI={0.153209383^1.284432215},prob=0.73]","[&CI={0.14828773^1.283005803},prob=0.14]","[&CI={0.094245034^1.063914276},prob=0.03]","[&CI={0.087433982^1.052861466},prob=0.79]","[&CI={0.061996041^0.965768234},prob=0.49]","[&CI={0.07431381^1.015638554},prob=0.72]","[&CI={0.070856181^0.966702569},prob=0.61]","[&CI={1.870802705^3.763080409},prob=0.92]","[&CI={0.076387695^0.656017395},prob=1]","[&CI={2.965383178^4.01816647},prob=0.59]","[&CI={1.924893958^3.643620656},prob=0.88]","[&CI={1.522162223^3.542347785},prob=0.92]","[&CI={0.812178354^2.644953159},prob=0.99]","[&CI={0.738121473^2.621542314},prob=0.74]","[&CI={0.544997053^2.539822755},prob=0.94]","[&CI={0.502536156^2.538069172},prob=0.62]","[&CI={0.186574865^1.317922462},prob=1]")

write.nexus(t.true, file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_ultimate_lbs_prob.timetree")