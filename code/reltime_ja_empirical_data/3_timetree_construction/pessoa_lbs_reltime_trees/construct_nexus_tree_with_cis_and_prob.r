



#source(file="/Users/josebarba/Desktop/script.r")
rm(list=ls())
require(ape)

t.true <- ape::read.tree(file="/Users/barba/Desktop/lbs_iqtree_reltime_timetrees/lbs-reltime_ultimate_timetrees/pessoa_lbs_reltime_trees/mrca_node_divtimes_timetree.nwk")
#t <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_utt_cah.timetree")
#t1 = ape::rotateConstr(t, t.true$tip.label) 
#t.new = ape::read.tree(text = ape::write.tree(t1))
#t.true$edge.length <- t.new$edge.length
t.true$node.label <- c("[&CI={0.490606439^0.54}^prob=1]","[&CI={0.277328187^0.346719844}^prob=1]","[&CI={0.270065408^0.343079599}^prob=0.6]","[&CI={0.208991471^0.30938126}^prob=1]","[&CI={0.153454509^0.246439996}^prob=1]","[&CI={0.125468546^0.225878841}^prob=1]","[&CI={0.119097444^0.224767754}^prob=1]","[&CI={0.097550866^0.206359038}^prob=1]","[&CI={0.08909943^0.196225429}^prob=1]","[&CI={0.040616752^0.106673605}^prob=1]","[&CI={0.020461222^0.071661045}^prob=1]","[&CI={0.002441746^0.029367195}^prob=1]","[&CI={0.047305455^0.126110475}^prob=1]","[&CI={0.045755003^0.103341325}^prob=1]",
	"[&CI={0.244853434^0.339310267}^prob=1]","[&CI={0.218833375^0.338023572}^prob=1]","[&CI={0.21758632^0.3369689}^prob=1]","[&CI={0.443164596^0.521184277}^prob=1]","[&CI={0.420878975^0.49771273}^prob=1]","[&CI={0.254254532^0.343974496}^prob=1]","[&CI={0.205281663^0.298824532}^prob=1]","[&CI={0.147257896^0.253300694}^prob=1]","[&CI={0.040456042^0.096398214}^prob=1]","[&CI={0.073378255^0.144955929}^prob=1]","[&CI={0.294290732^0.388276826}^prob=1]","[&CI={0.235673199^0.35698054}^prob=1]","[&CI={0.185065797^0.274261755}^prob=1]","[&CI={0.107957264^0.206565263}^prob=1]")

write.nexus(t.true, file="/Users/barba/Desktop/lbs_iqtree_reltime_timetrees/lbs-reltime_ultimate_timetrees/pessoa_lbs_reltime_trees/pessoa_ultimate_lbst_timetree.tre")














#source(file="/Users/josebarba/Desktop/script.r")
rm(list=ls())
require(ape)

t.true <- ape::read.tree(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/out_389_FINAL_timetree_no_outgroup.nwk")
t <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_utt_cah.timetree")
t1 = ape::rotateConstr(t, t.true$tip.label) 
t.new = ape::read.tree(text = ape::write.tree(t1))
t.true$edge.length <- t.new$edge.length
t.true$node.label <- c("[&CI={4.480865619^4.613619741}^prob=1]","[&CI={3.435331943^4.053952444}^prob=0.62]","[&CI={2.430813234^3.453300212}^prob=0.74]","[&CI={0.604038276^1.623862635}^prob=1]","[&CI={0.325395665^1.298919095}^prob=0.86]","[&CI={0.272552273^1.295525591}^prob=0.42]","[&CI={0.141433538^1.013796952}^prob=0.73]","[&CI={0.135997508^1.002369944}^prob=0.14]","[&CI={0.135088487^1.00235499}^prob=0.03]","[&CI={0.075392173^0.828939972}^prob=0.79]","[&CI={0.066050922^0.817842967}^prob=0.49]","[&CI={0.075640969^0.864649842}^prob=0.72]","[&CI={0.055912189^0.785690428}^prob=0.61]","[&CI={0.255857401^1.260832967}^prob=0.54]","[&CI={0.240057709^1.260832967}^prob=0.45]","[&CI={0.184500739^1.25995823}^prob=0.7]","[&CI={0.211131846^1.256773497}^prob=0.35]","[&CI={0.030909134^0.617279263}^prob=1]","[&CI={0.215132067^1.091651945}^prob=1]","[&CI={0.161013712^1.079243532}^prob=0.79]","[&CI={1.966064767^3.003649709}^prob=0.76]","[&CI={1.12452999^2.599811611}^prob=0.96]","[&CI={1.042567582^2.591116434}^prob=0.47]","[&CI={0.934552334^2.577308404}^prob=0.52]","[&CI={0.786137803^2.576396249}^prob=0.61]","[&CI={0.5940804^2.567337223}^prob=0.84]","[&CI={1.648850138^2.940719191}^prob=0.86]","[&CI={0.918210866^2.837565302}^prob=0.98]","[&CI={1.19938763^2.895091625}^prob=0.93]","[&CI={0.370198633^1.575860342}^prob=1]","[&CI={0.291738807^1.485781559}^prob=0.66]","[&CI={0.195571821^1.36747337}^prob=0.8]","[&CI={0.153209383^1.284432215}^prob=0.89]","[&CI={0.14828773^1.283005803}^prob=0.6]","[&CI={0.094245034^1.063914276}^prob=1]","[&CI={0.087433982^1.052861466}^prob=0.42]","[&CI={0.061996041^0.965768234}^prob=0.78]","[&CI={0.07431381^1.015638554}^prob=0.69]","[&CI={0.070856181^0.966702569}^prob=1]","[&CI={1.870802705^3.763080409}^prob=0.92]","[&CI={0.076387695^0.656017395}^prob=1]","[&CI={2.965383178^4.01816647}^prob=0.59]","[&CI={1.924893958^3.643620656}^prob=0.88]","[&CI={1.522162223^3.542347785}^prob=0.92]","[&CI={0.812178354^2.644953159}^prob=0.99]","[&CI={0.738121473^2.621542314}^prob=0.74]","[&CI={0.544997053^2.539822755}^prob=0.94]","[&CI={0.502536156^2.538069172}^prob=0.62]","[&CI={0.186574865^1.317922462}^prob=1]")
write.nexus(t.true, file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_ultimate_lbs_prob.timetree")











tree$node.label <- c("[&CI={4.480865619^4.613619741},prob=1]","[&CI={3.435331943^4.053952444},prob=0.62]","[&CI={2.430813234^3.453300212},prob=0.74]","[&CI={0.604038276^1.623862635},prob=0.76]","[&CI={0.325395665^1.298919095},prob=0.86]","[&CI={0.272552273^1.295525591},prob=0.93]","[&CI={0.141433538^1.013796952},prob=1]","[&CI={0.135997508^1.002369944},prob=0.66]","[&CI={0.135088487^1.00235499},prob=0.8]","[&CI={0.075392173^0.828939972},prob=0.89]","[&CI={0.066050922^0.817842967},prob=0.6]","[&CI={0.075640969^0.864649842},prob=1]","[&CI={0.055912189^0.785690428},prob=0.42]","[&CI={0.255857401^1.260832967},prob=0.78]","[&CI={0.240057709^1.260832967},prob=0.69]","[&CI={0.184500739^1.25995823},prob=1]","[&CI={0.211131846^1.256773497},prob=0.98]","[&CI={0.030909134^0.617279263},prob=0.96]","[&CI={0.215132067^1.091651945},prob=0.47]","[&CI={0.161013712^1.079243532},prob=0.52]","[&CI={1.966064767^3.003649709},prob=0.61]","[&CI={1.12452999^2.599811611},prob=0.84]","[&CI={1.042567582^2.591116434},prob=1]","[&CI={0.934552334^2.577308404},prob=1]","[&CI={0.786137803^2.576396249},prob=0.79]","[&CI={0.5940804^2.567337223},prob=0.86]","[&CI={1.648850138^2.940719191},prob=0.54]","[&CI={0.918210866^2.837565302},prob=0.45]","[&CI={1.19938763^2.895091625},prob=0.35]","[&CI={0.370198633^1.575860342},prob=1]","[&CI={0.291738807^1.485781559},prob=0.7]","[&CI={0.195571821^1.36747337},prob=0.42]","[&CI={0.153209383^1.284432215},prob=0.73]","[&CI={0.14828773^1.283005803},prob=0.14]","[&CI={0.094245034^1.063914276},prob=0.03]","[&CI={0.087433982^1.052861466},prob=0.79]","[&CI={0.061996041^0.965768234},prob=0.49]","[&CI={0.07431381^1.015638554},prob=0.72]","[&CI={0.070856181^0.966702569},prob=0.61]","[&CI={1.870802705^3.763080409},prob=0.92]","[&CI={0.076387695^0.656017395},prob=1]","[&CI={2.965383178^4.01816647},prob=0.59]","[&CI={1.924893958^3.643620656},prob=0.88]","[&CI={1.522162223^3.542347785},prob=0.92]","[&CI={0.812178354^2.644953159},prob=0.99]","[&CI={0.738121473^2.621542314},prob=0.74]","[&CI={0.544997053^2.539822755},prob=0.94]","[&CI={0.502536156^2.538069172},prob=0.62]","[&CI={0.186574865^1.317922462},prob=1]")
write.nexus(tree, file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_ultimate_lbs_prob.timetree")









#source(file="/Users/josebarba/Desktop/script.r")
rm(list=ls())
require(ape)

tree <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_utt_cah.timetree")#t.true$edge.length <- t$edge.length
tree$node.label <- c("[&CI={4.480865619^4.613619741},prob=1]","[&CI={3.435331943^4.053952444},prob=0.62]","[&CI={2.430813234^3.453300212},prob=0.74]","[&CI={0.604038276^1.623862635},prob=0.76]","[&CI={0.325395665^1.298919095},prob=0.86]","[&CI={0.272552273^1.295525591},prob=0.93]","[&CI={0.141433538^1.013796952},prob=1]","[&CI={0.135997508^1.002369944},prob=0.66]","[&CI={0.135088487^1.00235499},prob=0.8]","[&CI={0.075392173^0.828939972},prob=0.89]","[&CI={0.066050922^0.817842967},prob=0.6]","[&CI={0.075640969^0.864649842},prob=1]","[&CI={0.055912189^0.785690428},prob=0.42]","[&CI={0.255857401^1.260832967},prob=0.78]","[&CI={0.240057709^1.260832967},prob=0.69]","[&CI={0.184500739^1.25995823},prob=1]","[&CI={0.211131846^1.256773497},prob=0.98]","[&CI={0.030909134^0.617279263},prob=0.96]","[&CI={0.215132067^1.091651945},prob=0.47]","[&CI={0.161013712^1.079243532},prob=0.52]","[&CI={1.966064767^3.003649709},prob=0.61]","[&CI={1.12452999^2.599811611},prob=0.84]","[&CI={1.042567582^2.591116434},prob=1]","[&CI={0.934552334^2.577308404},prob=1]","[&CI={0.786137803^2.576396249},prob=0.79]","[&CI={0.5940804^2.567337223},prob=0.86]","[&CI={1.648850138^2.940719191},prob=0.54]","[&CI={0.918210866^2.837565302},prob=0.45]","[&CI={1.19938763^2.895091625},prob=0.35]","[&CI={0.370198633^1.575860342},prob=1]","[&CI={0.291738807^1.485781559},prob=0.7]","[&CI={0.195571821^1.36747337},prob=0.42]","[&CI={0.153209383^1.284432215},prob=0.73]","[&CI={0.14828773^1.283005803},prob=0.14]","[&CI={0.094245034^1.063914276},prob=0.03]","[&CI={0.087433982^1.052861466},prob=0.79]","[&CI={0.061996041^0.965768234},prob=0.49]","[&CI={0.07431381^1.015638554},prob=0.72]","[&CI={0.070856181^0.966702569},prob=0.61]","[&CI={1.870802705^3.763080409},prob=0.92]","[&CI={0.076387695^0.656017395},prob=1]","[&CI={2.965383178^4.01816647},prob=0.59]","[&CI={1.924893958^3.643620656},prob=0.88]","[&CI={1.522162223^3.542347785},prob=0.92]","[&CI={0.812178354^2.644953159},prob=0.99]","[&CI={0.738121473^2.621542314},prob=0.74]","[&CI={0.544997053^2.539822755},prob=0.94]","[&CI={0.502536156^2.538069172},prob=0.62]","[&CI={0.186574865^1.317922462},prob=1]")
write.nexus(tree, file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_ultimate_lbs_prob.timetree")



#source(file="/Users/josebarba/Desktop/script.r")
rm(list=ls())
require(ape)

t.true <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/out_389_FINAL_timetree_no_outgroup.nwk")
t <- ape::read.nexus(file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_utt_cah.timetree")
t1 = ape::rotateConstr(t, t.true$tip.label) 
t.new = ape::read.tree(text = ape::write.tree(t1))
t.true$edge.length <- t.new$edge.length

#t.true$node.label <- c("n51","n52","n53","n54","n55","n56","n57","n58","n59","n60","n61","n62","n63","n64","n65","n66","n67","n68","n69","n70","n71","n72","n73","n74","n75","n76","n77","n78","n79","n80","n81","n82","n83","n84","n85","n86","n87","n88","n89","n90","n91","n92","n93","n94","n95","n96","n97","n98","n99")
#t.true$node.label <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49)
t.true$node.label <- c("[&CI={4.480865619^4.613619741},prob=1]","[&CI={3.435331943^4.053952444},prob=0.62]","[&CI={2.430813234^3.453300212},prob=0.74]","[&CI={0.604038276^1.623862635},prob=0.76]","[&CI={0.325395665^1.298919095},prob=0.86]","[&CI={0.272552273^1.295525591},prob=0.93]","[&CI={0.141433538^1.013796952},prob=1]","[&CI={0.135997508^1.002369944},prob=0.66]","[&CI={0.135088487^1.00235499},prob=0.8]","[&CI={0.075392173^0.828939972},prob=0.89]","[&CI={0.066050922^0.817842967},prob=0.6]","[&CI={0.075640969^0.864649842},prob=1]","[&CI={0.055912189^0.785690428},prob=0.42]","[&CI={0.255857401^1.260832967},prob=0.78]","[&CI={0.240057709^1.260832967},prob=0.69]","[&CI={0.184500739^1.25995823},prob=1]","[&CI={0.211131846^1.256773497},prob=0.98]","[&CI={0.030909134^0.617279263},prob=0.96]","[&CI={0.215132067^1.091651945},prob=0.47]","[&CI={0.161013712^1.079243532},prob=0.52]","[&CI={1.966064767^3.003649709},prob=0.61]","[&CI={1.12452999^2.599811611},prob=0.84]","[&CI={1.042567582^2.591116434},prob=1]","[&CI={0.934552334^2.577308404},prob=1]","[&CI={0.786137803^2.576396249},prob=0.79]","[&CI={0.5940804^2.567337223},prob=0.86]","[&CI={1.648850138^2.940719191},prob=0.54]","[&CI={0.918210866^2.837565302},prob=0.45]","[&CI={1.19938763^2.895091625},prob=0.35]","[&CI={0.370198633^1.575860342},prob=1]","[&CI={0.291738807^1.485781559},prob=0.7]","[&CI={0.195571821^1.36747337},prob=0.42]","[&CI={0.153209383^1.284432215},prob=0.73]","[&CI={0.14828773^1.283005803},prob=0.14]","[&CI={0.094245034^1.063914276},prob=0.03]","[&CI={0.087433982^1.052861466},prob=0.79]","[&CI={0.061996041^0.965768234},prob=0.49]","[&CI={0.07431381^1.015638554},prob=0.72]","[&CI={0.070856181^0.966702569},prob=0.61]","[&CI={1.870802705^3.763080409},prob=0.92]","[&CI={0.076387695^0.656017395},prob=1]","[&CI={2.965383178^4.01816647},prob=0.59]","[&CI={1.924893958^3.643620656},prob=0.88]","[&CI={1.522162223^3.542347785},prob=0.92]","[&CI={0.812178354^2.644953159},prob=0.99]","[&CI={0.738121473^2.621542314},prob=0.74]","[&CI={0.544997053^2.539822755},prob=0.94]","[&CI={0.502536156^2.538069172},prob=0.62]","[&CI={0.186574865^1.317922462},prob=1]")

write.nexus(t.true, file="/Users/barba/Desktop/pu_dating/figures/pu_dating_plots_and_figures/fig2_timetrees/ar389_ultimate_lbs_prob.timetree")